{"id":"Dqk8","dependencies":[{"name":"/Users/pengxiuwen/dev/virtual-pet/tsconfig.json","includedInParent":true,"mtime":1652430899798},{"name":"/Users/pengxiuwen/dev/virtual-pet/package.json","includedInParent":true,"mtime":1652430899658},{"name":"phaser","loc":{"line":1,"column":19,"index":19},"parent":"/Users/pengxiuwen/dev/virtual-pet/src/scenes/home.tsx","resolved":"/Users/pengxiuwen/dev/virtual-pet/node_modules/phaser/dist/phaser.js"},{"name":"../../public/assets/dialogues","loc":{"line":2,"column":46,"index":75},"parent":"/Users/pengxiuwen/dev/virtual-pet/src/scenes/home.tsx","resolved":"/Users/pengxiuwen/dev/virtual-pet/public/assets/dialogues.ts"},{"name":"../utils","loc":{"line":3,"column":178,"index":286},"parent":"/Users/pengxiuwen/dev/virtual-pet/src/scenes/home.tsx","resolved":"/Users/pengxiuwen/dev/virtual-pet/src/utils/index.tsx"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.default=void 0;var t=r(require(\"phaser\")),e=require(\"../../public/assets/dialogues\"),a=require(\"../utils\");function r(t){return t&&t.__esModule?t:{default:t}}function n(t){return(n=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&\"function\"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?\"symbol\":typeof t})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}function o(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e,a){return e&&o(t.prototype,e),a&&o(t,a),Object.defineProperty(t,\"prototype\",{writable:!1}),t}function s(t,e){if(\"function\"!=typeof e&&null!==e)throw new TypeError(\"Super expression must either be null or a function\");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,\"prototype\",{writable:!1}),e&&u(t,e)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){var e=p();return function(){var a,r=y(t);if(e){var n=y(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return l(this,a)}}function l(t,e){if(e&&(\"object\"===n(e)||\"function\"==typeof e))return e;if(void 0!==e)throw new TypeError(\"Derived constructors may only return object or undefined\");return f(t)}function f(t){if(void 0===t)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return t}function p(){if(\"undefined\"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(\"function\"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var d=function(r){s(o,t.default.Scene);var n=h(o);function o(){var t;return i(this,o),(t=n.call(this,\"home\")).basicData={health:0,feeling:0,knowledge:0,relationship:0},t.currentShow=\"health\",t}return c(o,[{key:\"init\",value:function(){this.characterKey=(0,a.getCharacterKey)(),this.gameWidth=this.scale.width,this.gameHeight=this.scale.height,this.basicData=(0,a.getBasicData)()}},{key:\"preload\",value:function(){console.log(this.characterKey),this.load.spritesheet(this.characterKey,\"images/characters/\".concat(this.characterKey,\".png\"),{frameWidth:320,frameHeight:320})}},{key:\"create\",value:function(){var t=this;this.anims.create({key:\"\".concat(this.characterKey,\"-alive\"),frames:this.anims.generateFrameNames(this.characterKey,{start:0,end:2}),frameRate:3,repeat:-1}),this.character=this.add.sprite(.5*this.gameWidth,.5*this.gameHeight,this.characterKey).play(\"\".concat(this.characterKey,\"-alive\")),this.character.setInteractive(),this.character.on(\"pointerdown\",function(r){var n={dialogue:\"你好呀呀呀~ 今天下雨了呢，出门别忘记带伞鸭\",btns:[{text:e.confirmBtnText[Math.floor(Math.random()*e.confirmBtnText.length)],type:\"health\",value:2},{text:e.cancelBtnText[Math.floor(Math.random()*e.cancelBtnText.length)],type:\"feeling\",value:-1}]};(0,a.getKotoba)().then(function(e){n.dialogue=e,t.communicate(n)});var i=(0,a.getInteractTimes)();i>3&&(0,a.toggleTips)(t,\"今日互动加成已达上限_(:з」∠)_\"),(0,a.setInteractTimes)(i+1)},this),this.basicDataShower=this.add.dom(0,0,(0,a.showCurrentData)(\"health\",this.basicData[this.currentShow],this.onDataChange.bind(this))).setOrigin(0)}},{key:\"update\",value:function(){this.currentShow!==this.previousType&&(this.previousType=this.currentShow,this.updateDataShower())}},{key:\"updateDataShower\",value:function(){this.basicDataShower&&this.basicDataShower.destroy(),this.basicDataShower=this.add.dom(0,0,(0,a.showCurrentData)(this.currentShow,this.basicData[this.currentShow],this.onDataChange.bind(this))).setOrigin(0)}},{key:\"onDataChange\",value:function(t){var e=a.DATA_TYPES.indexOf(this.currentShow);this.currentShow=a.DATA_TYPES[e+t]}},{key:\"updateBasicData\",value:function(t,e){var r=this.basicData[t];r+=e,this.basicData[t]=r<0?0:r>10?10:r,(0,a.setBasicData)(this.basicData),this.updateDataShower()}},{key:\"onCloseDialogueFn\",value:function(t,e){this.character.setInteractive(),this.dialogModal.destroy(),this.updateBasicData(t,e),this.currentShow=t}},{key:\"communicate\",value:function(t){var e=this;if(this.character.disableInteractive(),0!==t.dialogue.length){var r=[];t.btns.forEach(function(t){var a={onClickFn:function(){return e.onCloseDialogueFn(t.type,t.value)},text:t.text};r.push(a)}),this.dialogModal=this.add.dom(0,0,(0,a.createDialogueDom)(\"dialogue\",{btnList:r})).setOrigin(0),(0,a.printText)(document.getElementById(\"modal-text\"),t.dialogue)}}}]),o}();exports.default=d;"},"sourceMaps":null,"error":null,"hash":"e7c8d59ff75205d9ec63dd5471f0e2b8","cacheData":{"env":{}}}